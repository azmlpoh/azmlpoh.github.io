<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>FNF工具箱</title>
	<link rel="stylesheet" href="styles.css">
</head>
<body>
	<div class="container">
		<header class="glass-effect glow-border light-spots">
			<h1 id="main-title">FNF工具箱</h1>
			<p class="subtitle" id="main-subtitle">选择您需要的工具</p>
			<div class="version-info">版本: 0.7.0</div>
			<button class="settings-btn enhanced-btn" onclick="openSettings()">设置</button>
		</header>

		<div class="homepage" id="homepage">
			<div class="tool-selection">
				<div class="tool-card glass-effect glow-border" onclick="selectTool('converter')">
					<div class="tool-name">转换器</div>
					<p class="tool-description">FNF文件格式转换工具，支持JSON、XML和LUA格式互转</p>
				</div>

				<div class="tool-card glass-effect glow-border" onclick="selectTool('splitter')">
					<div class="tool-name">分割帧动画</div>
					<p class="tool-description">贴图帧分割工具，支持PNG图片和XML动画数据分割</p>
				</div>

				<div class="tool-card glass-effect glow-border" onclick="selectTool('chart-converter')">
					<div class="tool-name">谱子转换</div>
					<p class="tool-description">FNF谱子格式转换工具，支持CNE转PE</p>
				</div>

				<div class="tool-card glass-effect glow-border" onclick="selectTool('developing')">
					<div class="tool-name">正在研发中</div>
					<p class="tool-description">更多功能即将推出</p>
				</div>
			</div>
		</div>

		<div class="converter-container glass-effect glow-border" id="converter-container">
			<div class="conversion-type">
				<div class="conversion-title">FNF文件转换器</div>
			</div>

			<button class="back-btn enhanced-btn" onclick="goHome()">返回主页</button>

			<div class="engine-selection">
				<div class="engine-card glass-effect glow-border active" onclick="selectEngine('codename')">
					<div class="engine-name">Codename Engine</div>
				</div>

				<div class="engine-card glass-effect glow-border" onclick="selectEngine('psych')">
					<div class="engine-name">Psych Engine</div>
				</div>
			</div>

			<div class="converter-container active" id="codename-converter">
				<div class="conversion-type">
					<div class="conversion-title">JSON → XML 转换</div>
				</div>

				<div class="converter-grid">
					<div class="input-section">
						<div class="section-title">输入</div>
						<textarea 
							id="codename-input" 
							class="enhanced-input" 
							placeholder="在此处粘贴 JSON 数据"
						></textarea>

						<div class="button-group">
							<button class="convert-btn enhanced-btn" onclick="convertCodename()">转换</button>
							<button class="clear-btn enhanced-btn" onclick="clearCodename()">清空</button>
						</div>
					</div>

					<div class="output-section">
						<div class="section-title">输出</div>
						<div class="output-content active" id="codename-output"></div>
						<button class="copy-btn" onclick="selectOutput('codename-output')">选择输出内容</button>
					</div>
				</div>
			</div>

			<div class="converter-container" id="psych-converter">
				<div class="conversion-type">
					<div class="conversion-title">Psych Engine 转换</div>
				</div>

				<div class="input-group">
					<label for="psych-conversion-type">选择转换类型</label>
					<select id="psych-conversion-type" class="enhanced-input" onchange="updatePsychOutput()">
						<option value="xml-to-json">XML → JSON 人物</option>
						<option value="xml-to-lua">XML → LUA 背景</option>
					</select>
				</div>

				<div class="converter-grid">
					<div class="input-section">
						<div class="section-title">输入</div>
						<textarea 
							id="psych-input" 
							class="enhanced-input" 
							placeholder="在此处粘贴人物 XML 数据"
						></textarea>

						<div class="button-group">
							<button class="convert-btn enhanced-btn" onclick="convertPsych()">转换</button>
							<button class="clear-btn enhanced-btn" onclick="clearPsych()">清空</button>
						</div>
					</div>

					<div class="output-section">
						<div class="section-title">输出</div>
						<div class="output-content active" id="psych-output"></div>
						<button class="copy-btn" onclick="selectOutput('psych-output')">选择输出内容</button>

						<div class="json-output-section" id="json-output-section">
							<div class="section-title">JSON 配置文件</div>
							<div class="output-content active" id="psych-json-output"></div>
							<button class="copy-btn" onclick="selectOutput('psych-json-output')">选择JSON内容</button>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="splitter-container glass-effect glow-border" id="splitter-container">
			<div class="conversion-type">
				<div class="conversion-title">贴图帧分割</div>
			</div>

			<button class="back-btn enhanced-btn" onclick="goHome()">返回主页</button>

			<div class="splitter-grid">
				<div class="input-section">
					<div class="section-title">输入文件</div>
					
					<div class="file-upload-section">
						<input type="file" id="png-file-input" class="file-input" accept=".png">
						<label for="png-file-input" class="file-label enhanced-btn">上传PNG图片</label>
						<p id="png-file-name" class="upload-status"></p>
					</div>
					
					<div class="file-upload-section">
						<input type="file" id="xml-file-input" class="file-input" accept=".xml">
						<label for="xml-file-input" class="file-label enhanced-btn">上传XML动画数据</label>
						<p id="xml-file-name" class="upload-status"></p>
					</div>
					
					<div id="animation-groups"></div>
				</div>
				
				<div class="output-section">
					<div class="section-title">动画预览</div>
					
					<div class="canvas-container">
						<canvas id="animation-canvas" class="animation-canvas"></canvas>
					</div>
					
					<div class="animation-controls">
						<button class="control-btn enhanced-btn" id="play-btn" onclick="togglePlay()">播放</button>
						<button class="control-btn enhanced-btn" id="stop-btn" onclick="stopAnimation()">停止</button>
						<button class="control-btn enhanced-btn" id="prev-btn" onclick="prevFrame()">上一帧</button>
						<button class="control-btn enhanced-btn" id="next-btn" onclick="nextFrame()">下一帧</button>
						
						<div class="fps-control">
							<label for="fps-input">FPS:</label>
							<input type="number" id="fps-input" class="fps-input enhanced-input" value="24" min="1" max="60">
						</div>
					</div>
					
					<button class="download-btn enhanced-btn" id="download-btn" onclick="downloadFrames()" disabled>下载分割图片(.zip)</button>
				</div>
			</div>
		</div>

		<div class="chart-converter-container glass-effect glow-border" id="chart-converter-container">
			<div class="conversion-type">
				<div class="conversion-title">谱子转换器</div>
			</div>

			<button class="back-btn enhanced-btn" onclick="goHome()">返回主页</button>

			<div class="converter-grid">
				<div class="input-section">
					<div class="section-title">输入文件</div>
					
					<div class="file-upload-section">
						<input type="file" id="cne-chart-file-main" class="file-input" accept=".json">
						<label for="cne-chart-file-main" class="file-label enhanced-btn">上传CNE谱子文件</label>
						<p id="cne-chart-file-name-main" class="upload-status"></p>
					</div>
					
					<div class="file-upload-section">
						<input type="file" id="cne-meta-file-main" class="file-input" accept=".json">
						<label for="cne-meta-file-main" class="file-label enhanced-btn">上传Meta文件</label>
						<p id="cne-meta-file-name-main" class="upload-status"></p>
					</div>
					
					<button class="convert-btn enhanced-btn" onclick="convertChartToPsychMain()">转换谱子</button>
				</div>
				
				<div class="output-section">
					<div class="section-title">输出</div>
					<div class="output-content active" id="chart-converter-output"></div>
					<button class="copy-btn" onclick="selectOutput('chart-converter-output')">选择输出内容</button>
					<button class="download-btn enhanced-btn" id="download-chart-btn-main" onclick="downloadPsychChartMain()" disabled>下载PE谱子</button>
				</div>
			</div>
		</div>

		<div class="developing-container glass-effect glow-border" id="developing-container">
			<div class="conversion-type">
				<div class="conversion-title">正在研发中</div>
			</div>

			<button class="back-btn enhanced-btn" onclick="goHome()">返回主页</button>

			<div class="developing-message">
				<h2>新功能正在开发中</h2>
				<p>我们正在努力开发更多实用功能，敬请期待！</p>
			</div>
		</div>
	</div>

	<div class="modal" id="settings-modal">
		<div class="modal-content glass-effect glow-border">
			<div class="modal-title">设置</div>

			<div class="settings-tabs">
				<div class="settings-tab active" onclick="openSettingsTab('function')">功能</div>
				<div class="settings-tab" onclick="openSettingsTab('credits')">制作人员</div>
			</div>

			<div class="settings-content active" id="function-settings">
				<div class="checkbox-group">
					<label class="checkbox-label">
						<input type="checkbox" id="spaces-checkbox" class="checkbox-input" checked>
						转换的文件带空格
					</label>
				</div>
			</div>

			<div class="settings-content" id="credits-settings">
				<div class="modal-title">制作人员</div>
				<ul class="credits-list">
					<li class="credits-item">
						<a href="https://b23.tv/qy8R56Q" class="credits-link" target="_blank">被晒成干的橙子</a>
					</li>
					<li class="credits-item">DeepSeek</li>
				</ul>
			</div>

			<button class="close-btn enhanced-btn" onclick="closeSettings()">关闭</button>
		</div>
	</div>

	<div class="notification" id="notification"></div>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
	
	<script src="utils.js"></script>
	<script src="converter.js"></script>
	<script src="splitter.js"></script>
	<script src="chart-converter.js"></script>
	<script src="main.js"></script>
</body>
</html>